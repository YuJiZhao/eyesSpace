---
title: 音乐
type: "music"
aside: false
comments: false
top_img: false
---

<!DOCTYPE html>
<html lang="th">

<head>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/YuJiZhao/picbed@css/aplayer.css">
    <script src="https://cdn.jsdelivr.net/gh/YuJiZhao/picbed@js/aplayer3.js"></script>
</head>

<body>
    <div id="aplayer"></div>
</body>
<script>
    var count = 0;

    $.get("https://api.i-meto.com/meting/api", {
        server: "netease",
        type: "playlist",
        id: "6936632013"
    }, res => {
        let n = Math.floor(Math.random() * 10)
        for (let i = 0; i < n; i++) res = res.sort(() => Math.random() - 0.5);
        $("#page").css({
            "background-image": `url('https://cdn.jsdelivr.net/gh/YuJiZhao/picbed/blog/song/${res[count].title}.png')`,
            "background-size": "100% 100%",
            "background-repeat": "no-repeat"
        })
        fun(res);
    });

    let fun = data => {
        const ap = new APlayer({
            container: document.getElementById('aplayer'),
            mini: false,
            autoplay: false,
            theme: '#FADFA3',
            loop: 'none',
            order: 'list',
            preload: 'none',
            volume: 0.7,
            mutex: true,
            lrcType: 3,
            listFolded: false,
            listMaxHeight: 90,
            audio: data
        });
        ap.on('ended', function () {
            count++;
            $("#page").css("background-image",
                `url('https://cdn.jsdelivr.net/gh/YuJiZhao/picbed/blog/song/${data[count].title}.png')`)
            $(".aplayer-played").css({
                "background": "rgb(20, 214, 214)"
            });
        });
    }

    let clear1 = setInterval(() => {
        // 修改初始页面
        $(".page-title").css("display", "none");
        $("#nav").css("background", "none")
        $("#nav a").css("color", "#9CBCD1")
        $("#page").css({
            "position": "fixed",
            "top": "0",
            "left": "0",
            "height": "100%",
            "width": "100%",
            "border-radius": "0px"
        })
        $("#footer").css("display", "none");

        // 删除组件
        $(".aplayer-icon.aplayer-icon-menu").css("display", "none");
        $(".aplayer-list").css("display", "none");
        $(".aplayer-icon.aplayer-icon-loop").css("display", "none");
        $(".aplayer-icon.aplayer-icon-order").css("display", "none");
        $(".aplayer.aplayer-withlist .aplayer-info").css({
            "border-bottom": "none"
        })
        // 修改样式
        $(".aplayer .aplayer-info .aplayer-music .aplayer-author").css({
            "color": "#fff"
        })
        $("#article-container").css({
            "overflow": "visible",
        })
        $("#aplayer-dHveJhAh").css({
            "overflow": "visible",
        })
        $(".aplayer").css({
            "background": "none",
            "color": "#fff"
        })
        $(".aplayer-body").css({
            "position": "fixed",
            "bottom": "5%",
            "left": "10%",
            "width": "80%"
        });
        $(".aplayer-lrc").css({
            "position": "fixed",
            "top": "45%",
            "left": "50%",
            "transform": "translate(-50%, -50%)",
            "width": "80%",
            "height": "70%",
        });
        $(".aplayer-lrc-contents").css({
            "margin-top": "20%"
        })
        $(".aplayer-played").css({
            "background": "rgb(20, 214, 214)"
        })
    }, 200)
    setTimeout(() => {
        clearInterval(clear1);
    }, 2000)

    // 监听歌词高度变化
    // let tNum = undefined;
    // let clear2 = setInterval(() => {
    //     if ($(".aplayer-lrc-contents").length != 0) {
    //         if ($(".aplayer-lrc-contents").css("transform").slice(22, 23) != 0) {
    //             tNum = $(".aplayer-lrc-contents").css("transform").slice(23, -1)
    //             clearInterval(clear2);
    //         }
    //     }
    // });
    // setInterval(() => {
    //     if (patNum != $(".aplayer-lrc-contents").css("transform").slice(23, -1) && tNum != undefined) {
    //         tNum = 2 * $(".aplayer-lrc-contents").css("transform").slice(23, -1)
    //         console.log("tNum:", tNum);
    //         console.log("transform", $(".aplayer-lrc-contents").css("transform").slice(23, -1))
    //         $(".aplayer-lrc-contents").style.transform = "translateY(-" + tNum + "px)"
    //     }
    // }, 100)
</script>

</html>